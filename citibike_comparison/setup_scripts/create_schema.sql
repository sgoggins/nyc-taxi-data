CREATE TABLE taxi_citibike_trips (
  type varchar,
  external_id integer,
  start_taxi_zone_id integer,
  end_taxi_zone_id integer,
  start_time timestamp without time zone,
  end_time timestamp without time zone,
  duration_in_seconds numeric,
  date date,
  day_of_week integer,
  hour_of_day integer,
  trip_distance numeric
);

CREATE TABLE holidays (date date);
CREATE UNIQUE INDEX idx_holidays ON holidays (date);
INSERT INTO holidays
VALUES ('2009-01-01'),
       ('2009-01-19'),
       ('2009-02-16'),
       ('2009-05-25'),
       ('2009-07-03'),
       ('2009-09-07'),
       ('2009-10-12'),
       ('2009-11-11'),
       ('2009-11-26'),
       ('2009-11-27'),
       ('2009-12-25'),
       ('2010-01-01'),
       ('2010-01-18'),
       ('2010-02-15'),
       ('2010-05-31'),
       ('2010-07-05'),
       ('2010-09-06'),
       ('2010-10-11'),
       ('2010-11-11'),
       ('2010-11-25'),
       ('2010-11-26'),
       ('2010-12-24'),
       ('2010-12-31'),
       ('2011-01-17'),
       ('2011-02-21'),
       ('2011-05-30'),
       ('2011-07-04'),
       ('2011-09-05'),
       ('2011-10-10'),
       ('2011-11-11'),
       ('2011-11-24'),
       ('2011-11-25'),
       ('2011-12-26'),
       ('2012-01-02'),
       ('2012-01-16'),
       ('2012-02-20'),
       ('2012-05-28'),
       ('2012-07-04'),
       ('2012-09-03'),
       ('2012-10-08'),
       ('2012-11-12'),
       ('2012-11-22'),
       ('2012-11-23'),
       ('2012-12-25'),
       ('2013-01-01'),
       ('2013-01-21'),
       ('2013-02-18'),
       ('2013-05-27'),
       ('2013-07-04'),
       ('2013-09-02'),
       ('2013-10-14'),
       ('2013-11-11'),
       ('2013-11-28'),
       ('2013-11-29'),
       ('2013-12-25'),
       ('2014-01-01'),
       ('2014-01-20'),
       ('2014-02-17'),
       ('2014-05-26'),
       ('2014-07-04'),
       ('2014-09-01'),
       ('2014-10-13'),
       ('2014-11-11'),
       ('2014-11-27'),
       ('2014-11-28'),
       ('2014-12-26'),
       ('2015-01-01'),
       ('2015-01-19'),
       ('2015-02-16'),
       ('2015-05-25'),
       ('2015-07-03'),
       ('2015-09-07'),
       ('2015-10-12'),
       ('2015-11-11'),
       ('2015-11-26'),
       ('2015-11-27'),
       ('2015-12-25'),
       ('2016-01-01'),
       ('2016-01-18'),
       ('2016-02-15'),
       ('2016-05-30'),
       ('2016-07-04'),
       ('2016-09-05'),
       ('2016-10-10'),
       ('2016-11-11'),
       ('2016-11-24'),
       ('2016-11-25'),
       ('2016-12-26'),
       ('2017-01-02'),
       ('2017-01-16'),
       ('2017-02-20'),
       ('2017-05-29'),
       ('2017-07-04'),
       ('2017-09-04'),
       ('2017-10-09'),
       ('2017-11-10'),
       ('2017-11-23'),
       ('2017-11-24'),
       ('2017-12-25');
